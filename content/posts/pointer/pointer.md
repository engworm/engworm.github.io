---
title: "参照でできること（初級編）"
date: 2022-05-06T19:05:57+09:00
draft: false
---

## 参照とは

下書き中．
C++では参照型がはじめの難関だと思います．
私はCからC++に入ったのでポインタには慣れていましたが，参照型は長年イマイチよくわかっていませんでした．
配列を題材に，参照について試行錯誤してみようと思います．

さて，わかりやすく説明するなら，参照とはエイリアス（別名）[^1]のことです．
下のコードをみてください．

```cpp
double *data;
data = new double[10];

double * &x = data;
```

dataはdoubleを指すポインタ型で，doubleを10個格納できる配列の先頭を指しています．
xはdoubleを指すポインタの別名（参照）というわけです．

```cpp
*(x+1) = 4.6;
cout << *(data+1) << endl;  // 4.6

x[1] = 2.;
cout << data[1] << endl;    // 2
```

xはポインタであることを意識するために，C likeに書いた上段とC++ likeに書いた下段を比べてみましょう．
1段目のコードではxのポインタに1（8Byte分）を足したものを逆参照し，値を代入しています．
ここでいう逆参照とは，日常用語としての逆参照のことです．
いずれにせよ，ポインタxを逆参照することで元のdataが書き換えられていることがわかります．

## 参照の威力（参照渡し）

参照型によってどんなことができるのでしょう．
具体的な例でみていきましょう．

doubleをN個格納する配列valに何かしらの操作を行う関数show, plusを次のように与えます．

- showはarrを画面に表示する
- plusはarr全てに1を足した配列をarrに上書きする

あまり関係ないので，constは落として読んでもらっても大丈夫です．[^2]

```cpp
void show(const double * const arr) { 
  for (int i = 0; i < N; ++i) {
    std::cout << arr[i] << std::endl;
  }
}

double plus(double * const &arr) { 
  std::cout << arr[1] << std::endl;
  arr[1] = 5.;  
}
```

[^1]:参照は別名なのだと思うと，参照型が必ず初期化されなければならない理由がわかりますね．存在しないものに名前をつけることはできませんから．

[^2]:安全のためにconstを適宜つけなければなりません．constの修飾に関しては，参考文献としてあげた[図解：constとポインタと参照](https://qiita.com/yohhoy/items/feadbe1a245caadc44f7)をあたってください．

## 参考文献

[C++プログラミング入門](https://www.amazon.co.jp/C-%E3%83%97%E3%83%AD%E3%82%B0%E3%83%A9%E3%83%9F%E3%83%B3%E3%82%B0%E5%85%A5%E9%96%80-%E3%82%B0%E3%83%AC%E3%82%B4%E3%83%AA%E3%83%BC-%E3%82%B5%E3%83%86%E3%82%A3%E3%82%A2/dp/4873110637)

[図解：constとポインタと参照](https://qiita.com/yohhoy/items/feadbe1a245caadc44f7)
